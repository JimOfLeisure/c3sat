package civ3decompress

type lengthCode struct {
	value, extraBits int
}

type lengthKey struct {
	keyBitLength int
	key   uint
}

var lengthLookup = map[lengthKey]lengthCode{
	{3, 0b101}:     lengthCode{2, 0},
	{3, 0b11}:      lengthCode{3, 0},
	{3, 0b100}:     lengthCode{4, 0},
	{3, 0b011}:     lengthCode{5, 0},
	{4, 0b0101}:    lengthCode{6, 0},
	{4, 0b0100}:    lengthCode{7, 0},
	{4, 0b0011}:    lengthCode{8, 0},
	{5, 0b00101}:   lengthCode{9, 0},
	{5, 0b00100}:   lengthCode{10, 1},
	{5, 0b00011}:   lengthCode{12, 2},
	{5, 0b00010}:   lengthCode{16, 3},
	{6, 0b000011}:  lengthCode{24, 4},
	{6, 0b000010}:  lengthCode{40, 5},
	{6, 0b000001}:  lengthCode{72, 6},
	{7, 0b0000001}: lengthCode{136, 7},
	{7, 0b0000000}: lengthCode{264, 8},
}

var offsetLookup = map[string]int{
	"11":       0x00,
	"1011":     0x01,
	"1010":     0x02,
	"10011":    0x03,
	"10010":    0x04,
	"10001":    0x05,
	"10000":    0x06,
	"011111":   0x07,
	"011110":   0x08,
	"011101":   0x09,
	"011100":   0x0a,
	"011011":   0x0b,
	"011010":   0x0c,
	"011001":   0x0d,
	"011000":   0x0e,
	"010111":   0x0f,
	"010110":   0x10,
	"010101":   0x11,
	"010100":   0x12,
	"010011":   0x13,
	"010010":   0x14,
	"010001":   0x15,
	"0100001":  0x16,
	"0100000":  0x17,
	"0011111":  0x18,
	"0011110":  0x19,
	"0011101":  0x1a,
	"0011100":  0x1b,
	"0011011":  0x1c,
	"0011010":  0x1d,
	"0011001":  0x1e,
	"0011000":  0x1f,
	"0010111":  0x20,
	"0010110":  0x21,
	"0010101":  0x22,
	"0010100":  0x23,
	"0010011":  0x24,
	"0010010":  0x25,
	"0010001":  0x26,
	"0010000":  0x27,
	"0001111":  0x28,
	"0001110":  0x29,
	"0001101":  0x2a,
	"0001100":  0x2b,
	"0001011":  0x2c,
	"0001010":  0x2d,
	"0001001":  0x2e,
	"0001000":  0x2f,
	"00001111": 0x30,
	"00001110": 0x31,
	"00001101": 0x32,
	"00001100": 0x33,
	"00001011": 0x34,
	"00001010": 0x35,
	"00001001": 0x36,
	"00001000": 0x37,
	"00000111": 0x38,
	"00000110": 0x39,
	"00000101": 0x3a,
	"00000100": 0x3b,
	"00000011": 0x3c,
	"00000010": 0x3d,
	"00000001": 0x3e,
	"00000000": 0x3f,
}
